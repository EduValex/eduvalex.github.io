---
import cv from '../../../../shared/data/cv-data.json';
const personal = cv.personal;
const projects = cv.projects;
const experience = cv.experience;
const skills = cv.skills;

const SERVICES = [
  {
    icon: 'üõ†Ô∏è',
    titleES: 'Desarrollo Web & Apps',
    titleEN: 'Web & App Development',
    descES: 'Sitios web corporativos, e-commerce, landing pages y aplicaciones web full-stack con React, Django, Rails y WordPress. Responsive, r√°pidos y optimizados para conversi√≥n.',
    descEN: 'Corporate websites, e-commerce, landing pages and full-stack web applications with React, Django, Rails and WordPress. Responsive, fast and conversion-optimized.',
    tags: ['React', 'WordPress', 'Django', 'E-Commerce', 'SaaS']
  },
  {
    icon: 'üîç',
    titleES: 'Auditor√≠as SEO',
    titleEN: 'SEO Audits',
    descES: 'An√°lisis t√©cnico completo de SEO on-page, velocidad de carga, estructura del sitio, Core Web Vitals y estrategia de keywords con reportes detallados y plan de acci√≥n.',
    descEN: 'Complete technical SEO on-page analysis, page speed, site structure, Core Web Vitals and keyword strategy with detailed reports and action plan.',
    tags: ['SEO On-Page', 'PageSpeed', 'Analytics', 'SEMrush']
  },
  {
    icon: 'ü§ñ',
    titleES: 'Asistentes IA Personalizados',
    titleEN: 'Custom AI Assistants',
    descES: 'Dise√±o e integraci√≥n de chatbots inteligentes con ChatGPT, Claude AI y modelos custom para automatizaci√≥n, atenci√≥n al cliente 24/7 y workflows empresariales.',
    descEN: 'Design and integration of intelligent chatbots with ChatGPT, Claude AI and custom models for automation, 24/7 customer service and business workflows.',
    tags: ['ChatGPT', 'Claude AI', 'Automation', 'Webhooks']
  },
  {
    icon: 'üîå',
    titleES: 'Integraciones & Plugins',
    titleEN: 'Integrations & Plugins',
    descES: 'Desarrollo de plugins WordPress personalizados, conexiones con APIs externas (Google, Instagram, Drive), pasarelas de pago y automatizaciones con webhooks.',
    descEN: 'Custom WordPress plugin development, external API connections (Google, Instagram, Drive), payment gateways and webhook automations.',
    tags: ['WordPress Plugins', 'APIs', 'Google Drive', 'Webhooks']
  }
];
---
<!DOCTYPE html>
<html lang="es" id="html-root">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Eduardo Valenzuela ‚Äî Full Stack Developer (Astro)</title>
    <meta name="description" content="Portfolio de Eduardo Valenzuela ‚Äî Full Stack Developer especializado en React, Django, WordPress y SEO" />
    <link rel="icon" href="/favicon.ico" />
    <!-- EmailJS SDK desde CDN -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
      :root { color-scheme: dark; }
      * { box-sizing: border-box; }
      body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background:#0f172a; color:#e2e8f0; transition: opacity .3s }
      a { color:#60a5fa; text-decoration:none }
      a:hover { text-decoration:underline }
      .container { max-width: 1100px; margin: 0 auto; padding: 2rem 1rem; }
      .panel { background: rgba(15,23,42,.6); border:1px solid rgba(148,163,184,.2); border-radius: 14px; padding: 1.5rem; margin-bottom:2rem; transition: transform .2s, box-shadow .2s }
      .panel:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.3) }
      .grid { display:grid; gap:1.5rem; grid-template-columns: repeat(auto-fill,minmax(300px,1fr)); }
      .grid-2 { display:grid; gap:1.5rem; grid-template-columns:1fr 1fr }
      .grid-skills { display:grid; gap:1.5rem; grid-template-columns:repeat(3,1fr) }
      @media (max-width:768px) { .grid-2, .grid-skills { grid-template-columns:1fr } .container { padding:1.5rem .75rem } }
      .btn { display:inline-block; background:#3b82f6; color:white; padding:.75rem 1.25rem; border-radius:.75rem; font-weight:600; border:none; cursor:pointer; transition: background .2s, transform .1s }
      .btn:hover { background:#2563eb; text-decoration:none; transform: scale(1.02) }
      .btn.secondary { background:#0ea5e9 }
      .btn.secondary:hover { background:#0284c7 }
      h1 { font-size: clamp(1.8rem, 4vw, 2.6rem); margin:0 0 .5rem; font-weight:800; line-height:1.2 }
      h2 { font-size: clamp(1.4rem, 3vw, 1.9rem); margin:0 0 1.25rem; font-weight:700; display:flex; align-items:center; gap:.6rem }
      h3 { font-size: 1.15rem; font-weight:600; margin:0; color:#f1f5f9 }
      p { line-height:1.7; margin:.5rem 0; color:#cbd5e1 }
      .hero { display:flex; align-items:center; gap:1.5rem; flex-wrap:wrap }
      .hero img { width:90px; height:90px; border-radius:18px; object-fit:cover; flex-shrink:0; box-shadow:0 4px 12px rgba(0,0,0,.3) }
      small { color:#94a3b8; font-size:.9rem }
      nav { position: sticky; top:0; z-index:50; backdrop-filter: blur(12px); background: rgba(15,23,42,.9); border-bottom:1px solid rgba(148,163,184,.2); box-shadow:0 2px 8px rgba(0,0,0,.2) }
      nav .inner { display:flex; gap:.75rem; align-items:center; justify-content:space-between; max-width:1100px; margin:0 auto; padding:.75rem 1rem; flex-wrap:wrap }
      nav a { color:#cbd5e1; text-decoration:none; padding:.4rem .7rem; border-radius:.5rem; font-size:.9rem; transition: background .15s; white-space:nowrap }
      nav a:hover { background: rgba(148,163,184,.15); text-decoration:none }
      .badges { display:flex; flex-wrap:wrap; gap:.5rem; align-items:center }
      .badge { background:#1e293b; border:1px solid rgba(148,163,184,.25); color:#e5e7eb; padding:.3rem .75rem; border-radius:999px; font-size:.8rem; white-space:nowrap; transition: background .2s }
      .badge:hover { background:#334155 }
      .lang-toggle { background:#1e293b; border:1px solid rgba(148,163,184,.3); border-radius:.5rem; padding:.25rem; display:flex; gap:.25rem }
      .lang-toggle button { background:transparent; border:none; color:#94a3b8; padding:.35rem .75rem; border-radius:.4rem; cursor:pointer; font-size:.85rem; transition: all .2s; font-weight:500 }
      .lang-toggle button.active { background:#3b82f6; color:white }
      .lang-toggle button:hover:not(.active) { background:rgba(148,163,184,.15); color:#cbd5e1 }
      /* Form */
      .field { display:flex; flex-direction:column; gap:.5rem; margin-bottom:1rem }
      .label { font-size:.9rem; color:#cbd5e1; font-weight:500 }
      .input, .textarea { width:100%; padding:.75rem .9rem; border-radius:.6rem; border:1px solid rgba(148,163,184,.3); background:#0b1220; color:#e2e8f0; outline:none; font-family:inherit; font-size:.95rem; transition: border-color .2s, box-shadow .2s }
      .input:focus, .textarea:focus { border-color:#3b82f6; box-shadow:0 0 0 3px rgba(59,130,246,.2) }
      .textarea { resize:vertical; min-height:140px; line-height:1.6 }
      .alert { border-radius:.6rem; padding:.85rem 1rem; font-size:.9rem; margin:.75rem 0 }
      .alert.success { background:rgba(16,185,129,.15); color:#34d399; border:1px solid rgba(16,185,129,.35) }
      .alert.error { background:rgba(239,68,68,.15); color:#f87171; border:1px solid rgba(239,68,68,.35) }
      /* Services */
      .service { position:relative; overflow:hidden; border-radius:12px; background: rgba(15,23,42,.6); border:1px solid rgba(148,163,184,.2); padding:1.75rem; transition: transform .2s, box-shadow .2s }
      .service:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,.4) }
      .service .icon-box { width:68px; height:68px; border-radius:16px; background: linear-gradient(135deg, rgba(59,130,246,.15), rgba(14,165,233,.15)); display:flex; align-items:center; justify-content:center; font-size:2.2rem; margin-bottom:1rem; transition: transform .3s }
      .service:hover .icon-box { transform: scale(1.1) rotate(5deg) }
      .service h3 { margin-bottom:.75rem; font-size:1.15rem }
      .service p { font-size:.9rem; color:#cbd5e1; line-height:1.65; margin-bottom:1.25rem }
      /* Contact info */
      .contact-info { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:1.25rem }
      .contact-info li { display:flex; align-items:start; gap:1rem }
      .contact-info li .icon { font-size:1.4rem; flex-shrink:0; line-height:1 }
      .contact-info li .detail { flex:1 }
      .contact-info li .detail strong { display:block; font-size:.75rem; text-transform:uppercase; letter-spacing:.5px; color:#64748b; margin-bottom:.25rem }
      .contact-info li a { color:#60a5fa; transition: color .2s }
      .contact-info li a:hover { color:#93c5fd; text-decoration:none }
      /* Section header */
      .section-header { text-align:center; max-width:650px; margin:0 auto 2rem }
      .section-header h2 { justify-content:center }
      .section-header p { color:#94a3b8; font-size:.95rem }
      /* Experience & Projects */
      .exp-card, .proj-card { background: rgba(15,23,42,.6); border:1px solid rgba(148,163,184,.2); border-radius:12px; padding:1.5rem; transition: transform .2s, box-shadow .2s }
      .exp-card:hover, .proj-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.3) }
      .exp-card h3, .proj-card h3 { margin-bottom:.5rem }
      .exp-card small, .proj-card small { color:#94a3b8; font-size:.85rem }
      .exp-card p, .proj-card p { margin:.75rem 0; font-size:.9rem; line-height:1.65 }
      .proj-card .actions { display:flex; gap:.75rem; margin-top:1rem; flex-wrap:wrap }
      .proj-card .actions .btn { padding:.5rem .9rem; font-size:.85rem }
      /* Hidden lang content */
      [data-lang]:not(.active) { display:none !important }
      [data-lang].active { display:block !important }
      .inline-lang:not(.active) { display:none !important }
      .inline-lang.active { display:inline !important }
    </style>
  </head>
  <body>
    <nav>
      <div class="inner">
        <div class="badges">
          <a href="#about" data-nav-es="Sobre m√≠" data-nav-en="About">Sobre m√≠</a>
          <a href="#services" data-nav-es="Servicios" data-nav-en="Services">Servicios</a>
          <a href="#experience" data-nav-es="Experiencia" data-nav-en="Experience">Experiencia</a>
          <a href="#projects" data-nav-es="Proyectos" data-nav-en="Projects">Proyectos</a>
          <a href="#skills" data-nav-es="Habilidades" data-nav-en="Skills">Habilidades</a>
          <a href="#contact" data-nav-es="Contacto" data-nav-en="Contact">Contacto</a>
        </div>
        <div class="badges">
          <div class="lang-toggle">
            <button data-lang-btn="es" class="active">ES</button>
            <button data-lang-btn="en">EN</button>
          </div>
          <a href="/" title="React version">‚öõÔ∏è React</a>
          <a href="/astro/" title="Astro version" class="badge">‚≠ê Astro</a>
        </div>
      </div>
    </nav>

    <main class="container">
      <!-- Hero -->
      <section class="panel">
        <div class="hero">
          <img src="/favicon.ico" alt="Eduardo Valenzuela" />
          <div style="flex:1">
            <h1 data-lang="es" class="active" style="display:block">Hola, soy {personal.name}</h1>
            <h1 data-lang="en" style="display:none">Hi, I'm {personal.name}</h1>
            <small>{personal.location}</small>
          </div>
        </div>
        <p data-lang="es" class="active" style="margin-top:1rem; display:block">
          Desarrollador Full‚ÄëStack. Aqu√≠ tienes mi CV en PDF listo para descargar.
        </p>
        <p data-lang="en" style="margin-top:1rem; display:none">
          Full‚ÄëStack Developer. Here's my resume in PDF ready to download.
        </p>
        <p style="margin-top:1.25rem">
          <a class="btn" href="/CV-Eduardo-Valenzuela.pdf" download>
            <span class="inline-lang active" data-lang="es">üìÑ Descargar CV</span>
            <span class="inline-lang" data-lang="en">üìÑ Download Resume</span>
          </a>
          <a class="btn secondary" href="#contact" style="margin-left:.75rem">
            <span class="inline-lang active" data-lang="es">üí¨ Contacto</span>
            <span class="inline-lang" data-lang="en">üí¨ Contact</span>
          </a>
        </p>
      </section>

      <!-- About -->
      <section id="about" class="panel">
        <h2>
          <span>üë®‚Äçüíª</span>
          <span class="inline-lang active" data-lang="es">Sobre m√≠</span>
          <span class="inline-lang" data-lang="en">About Me</span>
        </h2>
        <div data-lang="es" class="active" style="display:block">
          {cv.about.es.split('\n\n').map((par: string) => <p>{par}</p>)}
        </div>
        <div data-lang="en" style="display:none">
          {cv.about.en.split('\n\n').map((par: string) => <p>{par}</p>)}
        </div>
      </section>

      <!-- Services -->
      <section id="services">
        <div class="section-header">
          <h2>
            <span>üöÄ</span>
            <span class="inline-lang active" data-lang="es">¬øQu√© hago?</span>
            <span class="inline-lang" data-lang="en">What I Do</span>
          </h2>
          <p data-lang="es" class="active">Servicios de desarrollo y consultor√≠a digital para empresas y emprendedores</p>
          <p data-lang="en" style="display:none">Development and digital consulting services for businesses and entrepreneurs</p>
        </div>
        <div class="grid-2">
          {SERVICES.map(service => (
            <article class="service">
              <div class="icon-box">{service.icon}</div>
              <h3 data-lang="es" class="active" style="display:block">{service.titleES}</h3>
              <h3 data-lang="en" style="display:none">{service.titleEN}</h3>
              <p data-lang="es" class="active" style="display:block">{service.descES}</p>
              <p data-lang="en" style="display:none">{service.descEN}</p>
              <div class="badges">
                {service.tags.map(tag => <span class="badge">{tag}</span>)}
              </div>
            </article>
          ))}
        </div>
      </section>

      <!-- Experience -->
      <section id="experience">
        <h2>
          <span>üíº</span>
          <span class="inline-lang active" data-lang="es">Experiencia</span>
          <span class="inline-lang" data-lang="en">Experience</span>
        </h2>
        <div class="grid">
          {experience.map(exp => (
            <article class="exp-card">
              <h3>{exp.position}</h3>
              <small>{exp.company} ¬∑ {exp.period} ¬∑ {exp.location}</small>
              <p>{exp.description}</p>
              {exp.technologies && (
                <div class="badges">
                  {exp.technologies.map(t => <span class="badge">{t}</span>)}
                </div>
              )}
            </article>
          ))}
        </div>
      </section>

      <!-- Projects -->
      <section id="projects">
        <h2>
          <span>üöÄ</span>
          <span class="inline-lang active" data-lang="es">Proyectos destacados</span>
          <span class="inline-lang" data-lang="en">Featured Projects</span>
        </h2>
        <div class="grid">
          {projects.map(p => (
            <article class="proj-card">
              <h3>{p.name}</h3>
              <small>{p.technologies?.slice(0,4).join(', ')}</small>
              <p>{p.description}</p>
              <div class="actions">
                {p.github && <a href={p.github} target="_blank" rel="noreferrer" class="btn">
                  <span class="inline-lang active" data-lang="es">üíª C√≥digo</span>
                  <span class="inline-lang" data-lang="en">üíª Code</span>
                </a>}
                {p.demo && <a href={p.demo} target="_blank" rel="noreferrer" class="btn secondary">
                  <span class="inline-lang active" data-lang="es">üöÄ Demo</span>
                  <span class="inline-lang" data-lang="en">üöÄ Demo</span>
                </a>}
                {!p.github && !p.demo && <span style="opacity:.7">
                  <span class="inline-lang active" data-lang="es">üîí Privado</span>
                  <span class="inline-lang" data-lang="en">üîí Private</span>
                </span>}
              </div>
            </article>
          ))}
        </div>
      </section>

      <!-- Skills -->
      <section id="skills">
        <h2>
          <span>üí°</span>
          <span class="inline-lang active" data-lang="es">Habilidades</span>
          <span class="inline-lang" data-lang="en">Skills</span>
        </h2>
        <div class="grid-skills">
          <article class="panel">
            <h3>Frontend</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.frontend.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
          <article class="panel">
            <h3>Backend</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.backend.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
          <article class="panel">
            <h3 data-lang="es" class="active">Herramientas ¬∑ Bases de datos</h3>
            <h3 data-lang="en">Tools ¬∑ Databases</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.tools.databases.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
          <article class="panel">
            <h3>SEO & Analytics</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.tools.seoAnalytics.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
          <article class="panel">
            <h3 data-lang="es" class="active">Herramientas ¬∑ Dev & Deploy</h3>
            <h3 data-lang="en">Tools ¬∑ Dev & Deploy</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.tools.devTools.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
          <article class="panel">
            <h3>IA</h3>
            <div class="badges" style="margin-top:.75rem">
              {skills.ai.map(s => <span class="badge" title={`${s.level}%`}>{s.name}</span>)}
            </div>
          </article>
        </div>
      </section>

      <!-- Contact -->
      <section id="contact">
        <h2>
          <span>üì¨</span>
          <span class="inline-lang active" data-lang="es">Contacto</span>
          <span class="inline-lang" data-lang="en">Contact</span>
        </h2>
        <div class="grid-2">
          <!-- Contact info -->
          <div class="panel">
            <h3 data-lang="es" class="active">Informaci√≥n</h3>
            <h3 data-lang="en">Information</h3>
            <ul class="contact-info" style="margin-top:1.25rem">
              <li>
                <span class="icon">üìß</span>
                <div class="detail">
                  <strong>Email</strong>
                  <a href={`mailto:${personal.email}`}>{personal.email}</a>
                </div>
              </li>
              <li>
                <span class="icon">üì±</span>
                <div class="detail">
                  <strong data-lang="es" class="active">Tel√©fono / WhatsApp</strong>
                  <strong data-lang="en">Phone / WhatsApp</strong>
                  <a href={`https://wa.me/${personal.phone.replace(/\D/g,'')}`} target="_blank" rel="noreferrer">
                    {personal.phone} üí¨
                  </a>
                </div>
              </li>
              <li>
                <span class="icon">üìç</span>
                <div class="detail">
                  <strong data-lang="es" class="active">Ubicaci√≥n</strong>
                  <strong data-lang="en">Location</strong>
                  <a href="https://www.google.com/maps/place/Temuco,+Regi%C3%B3n+de+la+Araucan%C3%ADa,+Chile" target="_blank" rel="noreferrer">
                    {personal.location} üó∫Ô∏è
                  </a>
                </div>
              </li>
            </ul>
          </div>

          <!-- Contact form -->
          <div class="panel">
            <h3 data-lang="es" class="active">Env√≠ame un mensaje</h3>
            <h3 data-lang="en">Send me a message</h3>
            <form id="contact-form" style="margin-top:1.25rem">
              <input type="hidden" name="title" value="Portfolio" />
              <div class="field">
                <label for="name" class="label">
                  <span class="inline-lang active" data-lang="es">Nombre *</span>
                  <span class="inline-lang" data-lang="en">Name *</span>
                </label>
                <input id="name" name="name" type="text" class="input" placeholder="" required />
              </div>
              <div class="field">
                <label for="email" class="label">Email *</label>
                <input id="email" name="email" type="email" class="input" placeholder="tu@email.com" required />
              </div>
              <div class="field">
                <label for="message" class="label">
                  <span class="inline-lang active" data-lang="es">Mensaje *</span>
                  <span class="inline-lang" data-lang="en">Message *</span>
                </label>
                <textarea id="message" name="message" class="textarea" placeholder="" required></textarea>
              </div>
              <div id="form-status" role="status" aria-live="polite"></div>
              <button type="submit" class="btn" style="margin-top:.5rem">
                <span class="inline-lang active" data-lang="es">üì® Enviar Mensaje</span>
                <span class="inline-lang" data-lang="en">üì® Send Message</span>
              </button>
            </form>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer style="text-align:center; padding:2rem 0; color:#64748b; font-size:.85rem">
        <p>¬© 2025 Eduardo Valenzuela ‚Äî <span class="inline-lang active" data-lang="es">Hecho con</span><span class="inline-lang" data-lang="en">Built with</span> ‚≠ê Astro</p>
        <p style="margin-top:.5rem">
          <a href="/" style="color:#60a5fa">
            <span class="inline-lang active" data-lang="es">Ver versi√≥n React</span>
            <span class="inline-lang" data-lang="en">View React version</span>
          </a>
        </p>
      </footer>
    </main>

    <script>
      // EmailJS config inline
      const EMAILJS_CONFIG = {
        SERVICE_ID: 'service_35dui0c',
        TEMPLATE_ID: 'template_dlh2p8t',
        PUBLIC_KEY: 'qZw7aS4i2gCI3Wz2B',
      };

      // Language toggle
      let currentLang = 'es';
      const langButtons = document.querySelectorAll('[data-lang-btn]');
      const langContents = document.querySelectorAll('[data-lang]');
      const inlineLangs = document.querySelectorAll('.inline-lang');
      const navLinks = document.querySelectorAll('nav a[data-nav-es]');

      function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem('astro-lang', lang);
        
        // Toggle buttons
        langButtons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.langBtn === lang);
        });
        
        // Toggle content blocks - usar style.display para SSR
        langContents.forEach(el => {
          const isActive = el.dataset.lang === lang;
          el.classList.toggle('active', isActive);
          el.style.display = isActive ? 'block' : 'none';
        });
        
        // Toggle inline spans
        inlineLangs.forEach(el => {
          const isActive = el.dataset.lang === lang;
          el.classList.toggle('active', isActive);
          el.style.display = isActive ? 'inline' : 'none';
        });

        // Update nav links
        navLinks.forEach(link => {
          const text = lang === 'es' ? link.dataset.navEs : link.dataset.navEn;
          if (text) link.textContent = text;
        });

        // Update form placeholders
        const nameInput = document.getElementById('name');
        const messageInput = document.getElementById('message');
        if (nameInput) nameInput.placeholder = lang === 'es' ? 'Tu nombre' : 'Your name';
        if (messageInput) messageInput.placeholder = lang === 'es' ? 'Cu√©ntame sobre tu proyecto o idea...' : 'Tell me about your project or idea...';
      }

      langButtons.forEach(btn => {
        btn.addEventListener('click', () => setLanguage(btn.dataset.langBtn));
      });

      // Restore saved language
      const savedLang = localStorage.getItem('astro-lang');
      if (savedLang && savedLang !== 'es') {
        setLanguage(savedLang);
      }

      // EmailJS form
      const form = document.getElementById('contact-form');
      const status = document.getElementById('form-status');

      // Init EmailJS from CDN
      if (typeof emailjs !== 'undefined') {
        emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
      }

      function setStatus(type, message) {
        status.className = `alert ${type}`;
        status.textContent = message;
      }

      function validate(formData) {
        const name = formData.get('name')?.trim();
        const email = formData.get('email')?.trim();
        const message = formData.get('message')?.trim();
        if (!name || !email || !message) {
          return currentLang === 'es' 
            ? 'Por favor completa todos los campos' 
            : 'Please fill in all fields';
        }
        if (!/\S+@\S+\.\S+/.test(email)) {
          return currentLang === 'es' 
            ? 'Por favor ingresa un email v√°lido' 
            : 'Please enter a valid email';
        }
        return '';
      }

      form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const error = validate(formData);
        if (error) {
          setStatus('error', error);
          return;
        }
        setStatus('', '');
        const submitBtn = form.querySelector('button[type="submit"]');
        const prevHTML = submitBtn.innerHTML;
        submitBtn.disabled = true;
        submitBtn.innerHTML = currentLang === 'es' ? '‚è≥ Enviando...' : '‚è≥ Sending...';
        
        try {
          if (typeof emailjs === 'undefined') {
            throw new Error('EmailJS not loaded');
          }
          
          const result = await emailjs.sendForm(
            EMAILJS_CONFIG.SERVICE_ID,
            EMAILJS_CONFIG.TEMPLATE_ID,
            form
          );
          if (result.text === 'OK') {
            setStatus('success', currentLang === 'es' 
              ? '¬°Mensaje enviado! Te responder√© pronto üöÄ' 
              : 'Message sent! I\'ll reply soon üöÄ'
            );
            form.reset();
          } else {
            setStatus('error', currentLang === 'es' 
              ? 'Hubo un problema al enviar. Intenta nuevamente.' 
              : 'There was a problem sending. Please try again.'
            );
          }
        } catch (err) {
          console.error('EmailJS error:', err);
          setStatus('error', currentLang === 'es' 
            ? 'Hubo un error al enviar el mensaje. Cont√°ctame directamente por email.' 
            : 'There was an error sending the message. Contact me directly via email.'
          );
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML = prevHTML;
        }
      });
    </script>
  </body>
</html>
